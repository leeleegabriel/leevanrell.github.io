<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link href="https://fonts.googleapis.com/css?family=Merriweather:300|Raleway:400,700" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="shortcut icon" href="/assets/favicon.ico"/>
<title>Expanding your VMs in ESXi</title>
<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Expanding your VMs in ESXi - Lee Vanrell</title>
<meta property="og:title" content="Expanding your VMs in ESXi" />
<meta name="description" content="This was pesky enough that I thought it merited a small post. I recently ran out of media on my Ubuntu VM on my ESXi v6.5 homelab. And went on a small adventure trying to figure out what to slap in the terminal to get more space. So hopefully this might save someone else more time." />
<meta property="og:description" content="This was pesky enough that I thought it merited a small post. I recently ran out of media on my Ubuntu VM on my ESXi v6.5 homelab. And went on a small adventure trying to figure out what to slap in the terminal to get more space. So hopefully this might save someone else more time." />
<link rel="canonical" href="https://leeleegabriel.github.io/vm/esxi/2020/01/21/Expanding-your-VMs-in-ESXi/" />
<meta property="og:url" content="https://leeleegabriel.github.io/vm/esxi/2020/01/21/Expanding-your-VMs-in-ESXi/" />
<meta property="og:site_name" content="Lee Vanrell" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-01-21T18:10:00-06:00" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "Expanding your VMs in ESXi",
"datePublished": "2020-01-21T18:10:00-06:00",
"description": "This was pesky enough that I thought it merited a small post. I recently ran out of media on my Ubuntu VM on my ESXi v6.5 homelab. And went on a small adventure trying to figure out what to slap in the terminal to get more space. So hopefully this might save someone else more time.",
"url": "https://leeleegabriel.github.io/vm/esxi/2020/01/21/Expanding-your-VMs-in-ESXi/"}</script>
<!-- End Jekyll SEO tag -->
</head>
  <body>
    <main class="container">
      <section class="about">
        <a href="/"><img src="/assets/portfolio.png" alt="Lee Vanrell"></a>
        <h2 id="title">
          <a href="/">Lee Vanrell</a>
        </h2>
        <p class="tagline">Software Engineer</p>
        <ul class="social"><a href="https://github.com/leevanrell">
              <li>
                <i class="icon-github-circled"></i>
              </li>
            </a><a href="https://www.linkedin.com/in/leevanrell">
              <li>
                <i class="icon-linkedin-squared"></i>
              </li>
            </a><a href="https://twitter.com/lee_vanrell">
              <li>
                <i class="icon-twitter-squared"></i>
              </li>
            </a></ul><nav class="navigation">
            <ul>
              
                <li>
                  <a href="/about">About Me</a>
                </li>
              
                <li>
                  <a href="/bookmarks">Bookmarks</a>
                </li>
              
            </ul>
          </nav><p>&copy;
          2020</p>
      </section>
      <section class="content">
        <div class="post-container">
  <a class="post-link" href="/vm/esxi/2020/01/21/Expanding-your-VMs-in-ESXi/">
    <h2 class="post-title">Expanding your VMs in ESXi</h2>
  </a>
  <div class="post-meta">
    <ul class="post-categories"><li>VM</li><li>ESXi</li></ul>
    <div class="post-date"><i class="icon-calendar"></i>Jan 21, 2020</div>
  </div>
  <div class="post">
    <p>This was pesky enough that I thought it merited a small post. I recently ran out of media on my Ubuntu VM on my ESXi v6.5 homelab. And went on a small adventure trying to figure out what to slap in the terminal to get more space. So hopefully this might save someone else more time.</p>

<p>First go to the VM whose hdd you’d like to expand and click edit settings.
Then click the Hard disk option and enter your desired hdd size (make sure the VM is shutdown for this).</p>

<p><img src="/assets/img/esxi_vm_hdd.png" alt="ESXi Menu" /></p>

<p>Then boot your VM and click the gui option or ssh in. Make sure GParted is installed with:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ sudo apt install gparted
</code></pre></div></div>

<p>Start GParted and click the /dev/sda1 partition then click the Resize/Move button. Drag the partition to the right to consume the unallocated partition.</p>

<p><img src="/assets/img/esxi_vm_gparted.png" alt="GParted Menu" /></p>

<p>Normally, this is all you’d have to do for a regular linux machine, however, it uses logical volumes that have to be extended as well.</p>

<p>Run</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~ sudo fdisk -l
</code></pre></div></div>

<p>It should display something like this:</p>

<p><img src="/assets/img/esxi_vm_cmd_1.png" alt="fdisk output" /></p>

<p>The second entry, ubuntu–vg-root, is the volume we’re concerned with. The name will vary from machine to machine but it should still something like name–vg-root at end. You can ignore the swap partition.</p>

<p>Next run:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo lvresize /dev/mapper/ubuntu--vg-root -L +100g 
sudo resize2fs /dev/mapper/vg0-slash

</code></pre></div></div>

<p>Be sure to modify /dev/mapper/ubuntu–vg-root to match your fdisk -l output.
This extends your partition by 100g, insert however much you need. You can use 100%FREE instead of +100g and it should consume all available space; however, I couldn’t get it working for me.</p>

<p>That’s it!</p>

  </div></div>

      </section>
    </main><script async src="https://www.googletagmanager.com/gtag/js?id=UA-156487363-1"></script>
      <script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'UA-156487363-1');
	</script></body>
</html>
